# 九馆爸爸项目宪章 (Project Constitution)

<!--
Sync Impact Report:
- Version: 1.0.0 (初始宪章版本)
- New document creation
- Established core principles and development workflow
- Template initialization complete
-->

## 文档元数据 (Document Metadata)

**文档标题**: 九馆爸爸 AI 角色扮演平台开发宪章
**文档版本**: 1.0.0
**制定日期**: 2025-09-29
**最后修订**: 2025-09-29
**生效状态**: 立即生效

## 项目概览 (Project Overview)

**项目名称**: 九馆爸爸 (JiuGuanBaBa)
**项目愿景**: 构建下一代 AI 角色扮演对话平台生态系统
**技术栈**: Vue 3 + TypeScript + Node.js + Express + Prisma + SQLite/PostgreSQL
**架构模式**: Monorepo (Turbo + npm workspaces)

## 核心原则 (Core Principles)

### 原则一：生产就绪开发 (Production-Ready Development)

**原则声明**: 整个开发过程以上线为目标，不允许使用模拟数据或临时方案。

**具体要求**:
- ❌ 禁止使用模拟数据、mock数据、假数据
- ✅ 数据库缺少内容时，生成真实的游戏数据作为种子数据
- ✅ 所有API端点必须基于真实数据库查询
- ✅ 创建真实的角色、故事书、用户等基础数据

**执行标准**: 任何功能实现都必须能在生产环境直接部署运行，无需后续改造。

### 原则二：问题解决文档化 (Problem Documentation)

**原则声明**: 每次解决问题都必须记录在问题解决文档中，建立完整的知识库。

**具体要求**:
- 包含问题描述、解决方案、影响文件、代码示例
- 防止反复修改导致回归错误
- 为后续开发提供重要参考资料
- 建立项目历史和决策记录

**执行标准**: 每个重要问题解决后，必须在 `问题解决文档.md` 中添加详细记录。

### 原则三：代码质量保证 (Code Quality Assurance)

**原则声明**: 严格的代码质量标准，确保代码的可维护性和可扩展性。

**具体要求**:
- 所有TypeScript错误必须修复，不允许跳过
- 遵循现有项目架构和代码风格
- 每次修改前充分理解现有代码
- 确保所有功能在生产环境标准下工作

**执行标准**:
- TypeScript严格模式启用
- ESLint + Prettier 代码格式化
- 完整的错误处理和日志记录
- 统一的API响应格式

### 原则四：真实数据驱动 (Real Data Driven)

**原则声明**: 功能开发基于真实数据场景，拒绝虚假或临时数据。

**具体要求**:
- 创建完整的角色生态系统 (5+ 完整角色设定)
- 建立真实的用户交互场景
- 实现完整的 AI 对话流程
- 包含实际的评分、收藏、分享等社交功能

**执行标准**: 每个功能都有对应的真实数据支撑，可供实际使用和测试。

### 原则五：安全优先 (Security First)

**原则声明**: 安全是项目的基础要求，所有功能设计都要考虑安全性。

**具体要求**:
- API密钥严禁硬编码，使用环境变量
- JWT密钥在生产环境使用强随机密钥
- 输入验证使用Zod schema验证
- 实现完整的用户权限控制
- 定期进行安全审查

**执行标准**: 通过安全检查后才能部署到生产环境。

### 原则六：持续集成与测试 (CI/CD & Testing)

**原则声明**: 建立完整的测试体系和持续集成流程。

**具体要求**:
- API端点100%覆盖测试
- WebSocket实时通信测试
- 数据库完整性测试
- 前端组件单元测试
- 端到端业务流程测试

**执行标准**: 所有新功能都必须包含相应测试，确保代码质量。

## 技术架构治理 (Technical Architecture Governance)

### 数据库架构原则

**当前状态**: SQLite (开发) + 计划迁移到 PostgreSQL (生产)
**设计原则**:
- 完整的关系型设计
- 支持复杂查询和事务
- 预留扩展空间 (向量搜索、推荐系统)
- 完整的索引策略

### API设计原则

**设计标准**:
- RESTful API风格
- 统一的错误响应格式
- JWT认证体系
- 完整的权限控制
- 支持分页、搜索、排序

### 前端架构原则

**技术选型**: Vue 3 + TypeScript + Element Plus + Tailwind CSS
**设计系统**:
- 组件化设计
- 响应式布局
- 主题系统支持
- 国际化准备

## 开发工作流 (Development Workflow)

### 功能开发流程

1. **需求分析**: 明确功能目标和用户场景
2. **架构设计**: 设计数据模型和API接口
3. **实现开发**: 后端API + 前端界面
4. **测试验证**: 单元测试 + 集成测试
5. **文档更新**: 更新相关文档
6. **代码审查**: 安全和质量检查
7. **部署上线**: 生产环境部署

### 版本控制标准

**分支策略**:
- `main`: 主分支，生产就绪代码
- `develop`: 开发分支，集成新功能
- `feature/*`: 功能分支
- `hotfix/*`: 热修复分支

**提交规范**:
- 使用语义化提交信息
- 包含功能描述和影响范围
- 关联相关问题和文档

### 测试标准

**测试类型**:
- **单元测试**: Jest + ts-jest (后端), Vitest (前端)
- **集成测试**: API端点全覆盖测试
- **E2E测试**: 业务流程端到端验证
- **性能测试**: 响应时间和负载测试

**质量门禁**:
- 代码覆盖率 > 80%
- 所有测试用例通过
- 无TypeScript类型错误
- 通过安全扫描

## 项目管理治理 (Project Management Governance)

### 文档管理

**文档层次**:
1. **宪章文档** (本文档): 项目根本原则
2. **架构文档**: 技术实现细节
3. **API文档**: 接口规范说明
4. **用户文档**: 使用指南和部署说明
5. **问题文档**: 问题解决记录

### 质量保证

**代码审查**:
- 每个功能都需要代码审查
- 安全风险评估
- 性能影响分析
- 架构合规性检查

**部署控制**:
- 分阶段部署策略
- 回滚机制准备
- 监控和告警系统
- 健康检查机制

## 修订流程 (Amendment Process)

### 宪章修订

**修订触发条件**:
- 技术栈重大变更
- 架构模式调整
- 安全要求升级
- 团队工作流变化

**修订流程**:
1. 提出修订建议
2. 技术团队讨论
3. 影响评估分析
4. 修订版本发布
5. 团队培训传达

### 版本管理

**版本命名**: 使用语义化版本 (MAJOR.MINOR.PATCH)
- **MAJOR**: 重大原则变更，不向后兼容
- **MINOR**: 新增原则或重要流程调整
- **PATCH**: 澄清、改进措辞、小幅优化

## 合规性检查 (Compliance Review)

### 定期审查

**审查频率**: 每季度进行一次合规性审查
**审查内容**:
- 原则执行情况
- 开发工作流合规性
- 代码质量标准执行
- 安全要求落实
- 文档更新及时性

### 违规处理

**违规级别**:
- **轻微违规**: 提醒和指导
- **中等违规**: 要求整改
- **严重违规**: 阻止合并，要求重做

## 项目当前状态评估

### 完成度评估 (截至 2025-09-29)

**核心功能**: 90% 完成
- ✅ 用户认证和管理系统
- ✅ 角色创建和管理系统
- ✅ AI对话引擎 (支持多种模型)
- ✅ WebSocket实时通信
- ✅ 基础社交功能 (收藏、评分、关注)

**高级功能**: 75% 完成
- ✅ 情景剧本系统
- ✅ 世界观信息系统
- ✅ 渐进式功能披露
- 🔄 推荐系统 (开发中)
- 🔄 向量搜索 (规划中)

**基础设施**: 85% 完成
- ✅ 完整的API体系
- ✅ 前端组件库
- ✅ 数据库设计
- ✅ 部署脚本
- 🔄 监控系统 (规划中)

### 技术债务清单

**高优先级**:
1. SQLite → PostgreSQL 数据库迁移
2. API密钥安全加固
3. 单元测试体系建立
4. 性能监控系统实施

**中优先级**:
1. 缓存策略优化
2. 前端状态管理重构
3. OAuth 第三方登录完善
4. 日志系统标准化

### 下一阶段目标

**V2.0 规划重点**:
1. **性能优化**: 缓存、数据库优化、CDN部署
2. **功能增强**: AI图像生成、语音合成、高级推荐
3. **生态建设**: 角色市场、创作者激励、社区功能
4. **国际化**: 多语言支持、全球化部署

---

**宪章生效声明**: 本宪章自发布之日起生效，项目所有开发活动均应遵循本宪章规定的原则和流程。

**联系方式**: 项目相关问题请通过项目仓库Issues进行讨论和反馈。