# TavernAI Plus - 本地运行说明

## 🚀 快速开始

### 方式一：一键启动（推荐）
```bash
# 在项目根目录运行
./quick-start.sh
```

### 方式二：分步启动

#### 1. 启动后端 API
```bash
cd apps/api
npm run dev
```
后端会运行在 http://localhost:3001

#### 2. 启动前端（新终端）
```bash
cd apps/web
npm run dev
```
前端会运行在 http://localhost:3000

## 📌 访问地址

- **前端应用**: http://localhost:3000
- **API 文档**: http://localhost:3001/api-docs
- **管理后台**: http://localhost:3000/admin

## 🔑 默认账号

### 管理员账号
- 邮箱: admin@tavernai.com
- 密码: Admin123!@#

### 测试用户
- 邮箱: user@test.com
- 密码: User123!

## 💾 数据库

项目默认使用 SQLite 数据库，数据文件位于:
- `apps/api/prisma/dev.db`

如需重置数据库：
```bash
cd apps/api
rm prisma/dev.db
npx prisma db push
```

## 🔧 环境配置

配置文件位置:
- `.env.local` - 本地环境变量（优先）
- `apps/api/.env` - API 环境变量

### 必要的环境变量
```env
DATABASE_URL=file:./dev.db
JWT_SECRET=你的JWT密钥
PORT=3001
CLIENT_URL=http://localhost:3000
```

### AI API 配置（可选）
如果需要使用 AI 功能，请配置以下任一 API：
```env
# OpenAI
OPENAI_API_KEY=你的密钥

# Anthropic Claude
ANTHROPIC_API_KEY=你的密钥

# 或使用 NewAPI 代理
NEWAPI_KEY=你的密钥
NEWAPI_BASE_URL=https://api.newapi.com
```

## ⚠️ 常见问题

### 1. 端口被占用
修改 `.env.local` 中的端口配置：
```env
PORT=3002  # API 端口
CLIENT_URL=http://localhost:3001  # 前端端口
```

### 2. 依赖安装失败
```bash
# 使用 legacy-peer-deps
npm install --legacy-peer-deps
```

### 3. 数据库连接错误
确保 SQLite 数据库文件存在：
```bash
cd apps/api
npx prisma generate
npx prisma db push
```

### 4. 前端页面报错
部分页面组件尚未完全实现，但核心功能可用：
- API 端点完全可用
- 管理后台功能完整
- 基础聊天功能正常

## 📦 功能状态

### ✅ 已实现
- 用户认证系统（注册、登录、JWT）
- 多种 OAuth 登录（Google、Discord）
- 角色管理系统
- 聊天会话管理
- 订阅和支付系统
- 邮件服务
- 智能路由和负载均衡
- 实时监控系统
- 完整的管理后台

### 🚧 开发中
- 部分前端页面组件
- 市场功能界面
- 高级 AI 功能集成

## 🛠️ 开发工具

### 查看日志
```bash
# API 日志
tail -f apps/api/logs/app.log

# 前端构建日志
cd apps/web && npm run build
```

### 运行测试
```bash
# API 测试
cd apps/api && npm test

# 前端测试
cd apps/web && npm test
```

### 数据库管理
```bash
# 查看数据库
cd apps/api
npx prisma studio
```
访问 http://localhost:5555 查看数据库内容

## 📞 技术支持

如遇到问题，请检查：
1. Node.js 版本 >= 18
2. 所有依赖已正确安装
3. 环境变量配置正确
4. 端口未被占用

---

**提示**: 首次运行可能需要安装依赖，请耐心等待。如果遇到问题，尝试删除 `node_modules` 文件夹后重新安装。