# TavernAI Plus - 角色图像生成系统环境配置
# 复制此文件为 .env 并填入你的实际配置值

# ==============================================
# NewAPI 图像生成服务配置
# ==============================================

# NewAPI 访问密钥 (必需)
# 从你的 NewAPI 提供商获取
NEWAPI_KEY=sk-your-newapi-key-here

# NewAPI 服务端点 (必需)
# 默认端点或你的自定义端点
NEWAPI_BASE_URL=https://your-newapi-endpoint.com/v1

# 默认图像生成模型 (必需)
# 推荐模型: nano-banana, dall-e-3, stable-diffusion-xl
DEFAULT_MODEL=nano-banana

# 备用模型列表 (可选)
# 当主模型不可用时的备选方案
FALLBACK_MODELS=dall-e-3,stable-diffusion-xl,midjourney

# API 请求超时设置 (秒)
NEWAPI_TIMEOUT=120

# API 重试次数
NEWAPI_MAX_RETRIES=3

# ==============================================
# 图像存储配置
# ==============================================

# 图像存储根目录
IMAGE_STORAGE_PATH=./public/uploads/characters

# 头像存储子目录
AVATAR_STORAGE_PATH=avatars

# 背景图存储子目录
BACKGROUND_STORAGE_PATH=backgrounds

# 最大文件大小 (MB)
MAX_IMAGE_SIZE_MB=10

# 支持的图像格式
SUPPORTED_IMAGE_FORMATS=png,jpg,jpeg,webp

# ==============================================
# 生成控制配置
# ==============================================

# 最大并发生成数量
# 建议: 2-5，取决于服务器性能和API限制
MAX_CONCURRENT_GENERATIONS=3

# 生成队列最大长度
MAX_GENERATION_QUEUE_SIZE=50

# 单个用户最大日生成次数
MAX_DAILY_GENERATIONS_PER_USER=20

# 管理员无限制生成 (true/false)
ADMIN_UNLIMITED_GENERATIONS=true

# ==============================================
# MBTI 性格系统配置
# ==============================================

# 启用 MBTI 系统
ENABLE_MBTI_SYSTEM=true

# 默认 MBTI 类型 (当角色未指定时)
DEFAULT_MBTI_TYPE=ENFP

# 强制 MBTI 分类 (true/false)
# true: 所有角色必须有MBTI类型
# false: MBTI类型可选
REQUIRE_MBTI_TYPE=false

# MBTI 类型验证
VALIDATE_MBTI_TYPES=true

# ==============================================
# 图像质量和尺寸配置
# ==============================================

# 头像默认尺寸
AVATAR_WIDTH=512
AVATAR_HEIGHT=512

# 背景图默认尺寸
BACKGROUND_WIDTH=1920
BACKGROUND_HEIGHT=1080

# 图像质量 (1-100)
IMAGE_QUALITY=85

# 是否生成多种尺寸
GENERATE_MULTIPLE_SIZES=true

# 额外尺寸配置 (JSON格式)
ADDITIONAL_SIZES='[{"width":256,"height":256,"suffix":"_small"},{"width":1024,"height":1024,"suffix":"_large"}]'

# ==============================================
# 缓存和性能配置
# ==============================================

# 启用图像缓存
ENABLE_IMAGE_CACHE=true

# 缓存过期时间 (小时)
IMAGE_CACHE_EXPIRY_HOURS=24

# 启用CDN
ENABLE_CDN=false

# CDN基础URL
CDN_BASE_URL=https://your-cdn.com

# 启用图像压缩
ENABLE_IMAGE_COMPRESSION=true

# 压缩质量 (1-100)
COMPRESSION_QUALITY=80

# ==============================================
# 日志和监控配置
# ==============================================

# 启用详细日志
ENABLE_VERBOSE_LOGGING=true

# 日志级别 (debug, info, warn, error)
LOG_LEVEL=info

# 日志文件路径
LOG_FILE_PATH=./logs/image-generation.log

# 启用性能监控
ENABLE_PERFORMANCE_MONITORING=true

# 监控数据保留天数
MONITORING_RETENTION_DAYS=30

# ==============================================
# 安全配置
# ==============================================

# 启用生成频率限制
ENABLE_RATE_LIMITING=true

# 每分钟最大请求数
RATE_LIMIT_PER_MINUTE=10

# 白名单IP地址 (逗号分隔)
RATE_LIMIT_WHITELIST_IPS=127.0.0.1,::1

# 启用内容过滤
ENABLE_CONTENT_FILTERING=true

# 禁止的关键词 (逗号分隔)
BLOCKED_KEYWORDS=nsfw,explicit,violence

# 启用水印
ENABLE_WATERMARK=false

# 水印文本
WATERMARK_TEXT=TavernAI Plus

# ==============================================
# 错误处理和恢复配置
# ==============================================

# 启用自动重试
ENABLE_AUTO_RETRY=true

# 重试间隔 (秒)
RETRY_INTERVAL_SECONDS=30

# 最大重试次数
MAX_RETRY_ATTEMPTS=3

# 启用失败回退
ENABLE_FALLBACK_ON_FAILURE=true

# 默认头像路径 (生成失败时使用)
DEFAULT_AVATAR_PATH=./public/images/default-avatar.png

# 默认背景路径 (生成失败时使用)
DEFAULT_BACKGROUND_PATH=./public/images/default-background.jpg

# ==============================================
# 开发和调试配置
# ==============================================

# 开发模式
NODE_ENV=development

# 启用调试模式
DEBUG_MODE=false

# 保存原始提示词
SAVE_ORIGINAL_PROMPTS=true

# 启用测试模式 (使用模拟数据)
TEST_MODE=false

# 测试用占位符图片URL
TEST_PLACEHOLDER_URL=https://via.placeholder.com/512x512

# ==============================================
# 数据库配置 (如果需要单独配置)
# ==============================================

# 数据库连接字符串
# DATABASE_URL="file:./dev.db"

# 启用数据库日志
# DATABASE_LOGGING=false

# 连接池大小
# DATABASE_POOL_SIZE=10

# ==============================================
# 集成服务配置
# ==============================================

# 启用 Discord 集成
ENABLE_DISCORD_INTEGRATION=false

# Discord Bot Token
# DISCORD_BOT_TOKEN=your-discord-bot-token

# 启用 Telegram 集成
ENABLE_TELEGRAM_INTEGRATION=false

# Telegram Bot Token
# TELEGRAM_BOT_TOKEN=your-telegram-bot-token

# ==============================================
# 高级功能配置
# ==============================================

# 启用情感分析
ENABLE_EMOTION_ANALYSIS=false

# 情感分析API密钥
# EMOTION_API_KEY=your-emotion-api-key

# 启用风格迁移
ENABLE_STYLE_TRANSFER=false

# 风格迁移模型
# STYLE_TRANSFER_MODEL=neural-style-transfer

# 启用背景移除
ENABLE_BACKGROUND_REMOVAL=false

# 背景移除API密钥
# BACKGROUND_REMOVAL_API_KEY=your-bg-removal-key

# ==============================================
# 使用示例
# ==============================================
#
# 基础配置示例:
# NEWAPI_KEY=sk-ap3W4RSYQgxXsatCrAog6dZwYKnxs12rHcyokvjIkPmgGZuY
# NEWAPI_BASE_URL=https://ttkk.inping.com/v1
# DEFAULT_MODEL=nano-banana
# IMAGE_STORAGE_PATH=./public/uploads/characters
# MAX_CONCURRENT_GENERATIONS=3
# ENABLE_MBTI_SYSTEM=true
# DEFAULT_MBTI_TYPE=ENFP
#
# 生产环境配置示例:
# NODE_ENV=production
# ENABLE_CDN=true
# CDN_BASE_URL=https://images.yourdomain.com
# ENABLE_RATE_LIMITING=true
# RATE_LIMIT_PER_MINUTE=5
# ENABLE_CONTENT_FILTERING=true
# IMAGE_QUALITY=90
# ENABLE_IMAGE_COMPRESSION=true
#
# ==============================================
