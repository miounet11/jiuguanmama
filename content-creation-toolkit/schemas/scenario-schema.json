{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "九馆爸爸世界剧本数据结构",
  "description": "完整的世界剧本JSON数据结构定义，确保所有场景数据的一致性和完整性",
  "type": "object",
  "required": ["name", "description", "category", "worldInfos"],
  "properties": {
    "name": {
      "type": "string",
      "minLength": 2,
      "maxLength": 50,
      "description": "场景名称，建议4-8个字符，具有特色和辨识度"
    },
    "description": {
      "type": "string",
      "minLength": 100,
      "maxLength": 800,
      "description": "场景的详细描述，包括世界观、背景、特色等，200-400字为佳"
    },
    "content": {
      "type": "string",
      "description": "可选的详细剧本内容，包括完整的故事情节"
    },
    "category": {
      "type": "string",
      "enum": [
        "奇幻冒险",
        "历史架空",
        "现代都市",
        "科幻未来",
        "悬疑推理",
        "校园恋爱",
        "末世生存",
        "时空酒馆",
        "通用"
      ],
      "description": "场景分类，用于系统分类和推荐"
    },
    "tags": {
      "type": "array",
      "items": {
        "type": "string",
        "minLength": 1,
        "maxLength": 20
      },
      "minItems": 1,
      "maxItems": 10,
      "description": "场景标签，用于搜索和分类"
    },
    "language": {
      "type": "string",
      "default": "zh-CN",
      "description": "场景使用的语言"
    },
    "isPublic": {
      "type": "boolean",
      "default": true,
      "description": "是否公开，默认为公开"
    },
    "isActive": {
      "type": "boolean",
      "default": true,
      "description": "是否启用，默认为启用"
    },
    "version": {
      "type": "integer",
      "minimum": 1,
      "default": 1,
      "description": "版本号，从1开始"
    },
    "parentId": {
      "type": "string",
      "description": "父场景ID，用于场景的层级关系"
    },
    "worldInfos": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["title", "content", "keywords", "priority"],
        "properties": {
          "title": {
            "type": "string",
            "minLength": 2,
            "maxLength": 50,
            "description": "世界信息标题"
          },
          "content": {
            "type": "string",
            "minLength": 20,
            "maxLength": 1000,
            "description": "世界信息内容，详细描述相关设定"
          },
          "keywords": {
            "type": "array",
            "items": {
              "type": "string",
              "minLength": 1,
              "maxLength": 20
            },
            "minItems": 1,
            "maxItems": 20,
            "description": "触发关键词列表"
          },
          "priority": {
            "type": "integer",
            "minimum": 0,
            "maximum": 1000,
            "description": "优先级，数值越高优先级越高"
          },
          "insertDepth": {
            "type": "integer",
            "minimum": 1,
            "maximum": 10,
            "default": 4,
            "description": "插入深度，控制信息在对话中的位置"
          },
          "probability": {
            "type": "number",
            "minimum": 0,
            "maximum": 1,
            "default": 1,
            "description": "触发概率，0-1之间的小数"
          },
          "matchType": {
            "type": "string",
            "enum": ["contains", "exact", "regex", "fuzzy"],
            "default": "contains",
            "description": "匹配类型：包含、精确、正则、模糊"
          },
          "caseSensitive": {
            "type": "boolean",
            "default": false,
            "description": "是否大小写敏感"
          },
          "isActive": {
            "type": "boolean",
            "default": true,
            "description": "是否启用此世界信息"
          },
          "triggerOnce": {
            "type": "boolean",
            "default": false,
            "description": "是否只触发一次"
          },
          "excludeRecursion": {
            "type": "boolean",
            "default": true,
            "description": "是否排除递归触发"
          },
          "category": {
            "type": "string",
            "default": "通用",
            "description": "世界信息分类"
          },
          "group": {
            "type": "string",
            "description": "世界信息分组"
          },
          "position": {
            "type": "string",
            "enum": ["before", "after", "replace"],
            "default": "before",
            "description": "信息插入位置：之前、之后、替换"
          }
        }
      },
      "description": "世界信息列表，定义场景的各个方面"
    },
    "characters": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["characterId", "role"],
        "properties": {
          "characterId": {
            "type": "string",
            "description": "关联的角色ID或名称"
          },
          "role": {
            "type": "string",
            "description": "角色在此场景中的特殊定位或身份"
          },
          "relationship": {
            "type": "string",
            "description": "与其他角色的关系设定"
          },
          "importance": {
            "type": "string",
            "enum": ["primary", "secondary", "background"],
            "default": "secondary",
            "description": "角色重要性：主要、次要、背景"
          },
          "availability": {
            "type": "string",
            "enum": ["always", "conditional", "rare"],
            "default": "always",
            "description": "角色可用性：总是、条件性、稀有"
          }
        }
      },
      "description": "关联的角色列表及其在场景中的设定"
    },
    "settings": {
      "type": "object",
      "properties": {
        "difficulty": {
          "type": "string",
          "enum": ["easy", "medium", "hard"],
          "default": "medium",
          "description": "场景难度级别"
        },
        "duration": {
          "type": "string",
          "enum": ["short", "medium", "long", "unlimited"],
          "default": "unlimited",
          "description": "场景持续时间预期"
        },
        "playerCount": {
          "type": "object",
          "properties": {
            "min": {
              "type": "integer",
              "minimum": 1,
              "default": 1
            },
            "max": {
              "type": "integer",
              "minimum": 1,
              "default": 1
            }
          },
          "description": "支持的玩家数量范围"
        },
        "ageRating": {
          "type": "string",
          "enum": ["all", "teen", "mature"],
          "default": "all",
          "description": "年龄分级"
        }
      },
      "description": "场景设置和参数"
    },
    "metadata": {
      "type": "object",
      "properties": {
        "createdBy": {
          "type": "string",
          "description": "创建者标识"
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "创建时间"
        },
        "updatedAt": {
          "type": "string",
          "format": "date-time",
          "description": "更新时间"
        },
        "source": {
          "type": "string",
          "description": "来源信息"
        },
        "inspiration": {
          "type": "string",
          "description": "灵感来源"
        },
        "references": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "参考资料"
        }
      },
      "description": "场景元数据"
    }
  },
  "additionalProperties": false
}
