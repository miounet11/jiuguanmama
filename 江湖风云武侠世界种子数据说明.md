# 江湖风云：武侠崛起世界种子数据使用说明

## 概述

基于"世界剧本+角色卡"系统化方式创建的完整武侠世界种子数据，包含了醉仙楼风云际会的江湖传奇故事。

## 核心内容

### 🎭 主要角色
1. **柳烟儿** - 病娇师妹，占有欲极强，对师兄/师姐有复杂情感
2. **慕容渊** - 霸道摄政王，内心孤独，掌控朝政却渴望真情
3. **萧尘** - 丐帮帮主，表面邋遢实则皇室血脉，寻求复国机会
4. **殷红** - 血影教刺客，冷艳杀手暗藏柔情，渴望救赎

### 🌍 世界设定
- **时代背景**: 大玄王朝末年，江湖动荡
- **核心地点**: 醉仙楼（各方势力汇聚之地）
- **主要冲突**: 血脉玉争夺战，正邪势力角逐
- **门派势力**: 剑宗、慕容世家、丐帮、血影教等

### 📚 世界信息系统
- 血脉玉传说（神秘宝物）
- 江湖门派势力分布
- 武功等级体系
- 醉仙楼详细设定
- 当前江湖局势分析

## 快速部署

### 1. 环境准备
```bash
cd /Users/lu/Documents/jiuguanbaba/cankao/tavernai-plus/apps/api
```

### 2. 初始化江湖世界数据
```bash
# 给脚本执行权限
chmod +x init-jianghu-world.sh

# 运行初始化（会备份现有数据库）
./init-jianghu-world.sh
```

### 3. 验证数据完整性
```bash
# 运行验证脚本
npx ts-node verify-jianghu-data.ts
```

### 4. 启动服务器
```bash
# 在根目录运行
cd ../../
npm run dev
```

## 登录信息

### 管理员账户
- **邮箱**: `admin@jianghu-wuxia.com`
- **密码**: `Admin123!@#`
- **权限**: 完整管理权限

### 测试用户
1. **武林新人** - `newbie@jianghu-test.com` (密码: `Test123456`)
2. **江湖老手** - `veteran@jianghu-test.com` (密码: `Test123456`)

## 数据结构详情

### 角色卡格式兼容性
- 完全兼容 SillyTavern 角色卡格式
- 包含丰富的人物背景和对话示例
- 支持好感度和触发器系统
- 古典武侠语言风格

### 世界剧本系统
- 分层式世界信息架构
- 优先级权重系统
- 关键词标签索引
- 动态事件触发机制

### 角色关联关系
- 多角色互动系统
- 情感状态追踪
- 剧情分支管理
- 冲突与合作机制

## 高级功能

### 情感系统
每个角色都有独立的情感状态追踪：
- **柳烟儿**: 好感度/黑化等级
- **慕容渊**: 好感度/结盟状态
- **萧尘**: 好感度/忠诚度
- **殷红**: 好感度/敌对等级

### 触发器系统
基于玩家行为的动态剧情：
- 角色互动触发器
- 道德路线选择影响
- 物品赠送反馈
- 战斗结果后果

### 武侠元素
- 门派体系完整
- 武功等级分层
- 江湖声望系统
- 正邪路线分化

## 故事线索

### 主线任务
1. **血脉玉之谜** - 探索神秘宝物的秘密
2. **师门恩怨** - 处理与剑宗的复杂关系
3. **朝堂风云** - 卷入慕容渊的政治斗争
4. **复国大业** - 协助萧尘的皇室复仇
5. **救赎之路** - 帮助殷红脱离血腥过往

### 角色剧情
- **柳烟儿线**: 师妹情深与病娇占有的矛盾
- **慕容渊线**: 权势与真情的选择
- **萧尘线**: 义气与复仇的平衡
- **殷红线**: 杀手与人性的救赎

## 文件结构

```
tavernai-plus/apps/api/
├── prisma/
│   ├── seed-jianghu-wuxia.ts      # 完整种子数据脚本
│   └── schema.prisma              # 数据库架构
├── init-jianghu-world.sh          # 一键初始化脚本
├── verify-jianghu-data.ts         # 数据验证脚本
└── ...
```

## 开发特性

### 代码质量
- TypeScript 严格模式
- 完整的错误处理
- 数据验证机制
- 类型安全保证

### 数据安全
- 自动数据库备份
- 种子数据版本控制
- 完整性验证
- 回滚机制

### 扩展性设计
- 模块化角色定义
- 可配置世界参数
- 插件式触发器
- 多语言支持准备

## 故障排除

### 常见问题

1. **初始化失败**
   ```bash
   # 检查 Prisma 设置
   npx prisma generate
   
   # 手动重置数据库
   npx prisma migrate reset --force
   ```

2. **角色数据不完整**
   ```bash
   # 重新运行种子数据
   npx ts-node prisma/seed-jianghu-wuxia.ts
   ```

3. **验证失败**
   ```bash
   # 查看详细错误信息
   npx ts-node verify-jianghu-data.ts
   ```

### 日志查看
```bash
# 查看数据库内容
npx prisma studio

# 检查服务器日志
npm run dev
```

## 技术规范

### 数据库要求
- SQLite 3.x (开发环境)
- PostgreSQL 12+ (生产环境)
- Prisma ORM 5.x

### 依赖项
- Node.js 18+
- TypeScript 5.x
- bcryptjs (密码加密)
- UUID (唯一标识符)

## 定制指南

### 添加新角色
1. 在 `seed-jianghu-wuxia.ts` 中添加角色定义
2. 创建对应的世界信息条目
3. 建立角色关联关系
4. 更新验证脚本

### 修改世界设定
1. 编辑世界信息条目
2. 调整角色背景故事
3. 更新触发器逻辑
4. 测试数据完整性

### 扩展剧情线
1. 增加新的世界信息条目
2. 创建额外的触发器
3. 设计角色互动场景
4. 验证故事连贯性

## 许可和使用

本种子数据遵循项目整体许可协议，仅供学习和开发使用。角色设定和故事内容为原创作品，请尊重知识产权。

---

**Created by**: 九馆爸爸开发团队  
**Version**: 1.0.0  
**Last Updated**: 2025-09-28  
**Contact**: 通过项目 GitHub Issues 联系